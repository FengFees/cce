# 集群使能服务网格<a name="cce_01_0036"></a>

启用ISTIO服务网格为您的服务以无侵入的方式提供灵活的服务治理能力。集成Kubernetes平台，无需修改任何服务代码，也无需手动安装代理，只需开启ISITO服务网格功能，即可实现灰度发布、流量管理、熔断、监控、调用链等丰富的服务治理能力。

在创建容器应用前，您需要存在一个可用集群，并确保集群版本为1.9及以上，并开启服务网格能力，当前仅支持新集群以及部分新版本集群使能服务网格能力。

## 什么是服务网格能力<a name="section1379218452"></a>

服务网格通过无侵入的方式提供了熔断容错、故障注入、流量管理等服务治理能力。

## 如何使用服务网格<a name="section2086419142214"></a>

-   启用istio服务网格有两处操作入口：1. 虚拟机集群创建完成页，可以通过选择“启用Istio服务网格“进行启用； 2. 集群列表页，可以通过集群卡片上的“启用Istio“进行启用。创建集群步骤请参见[创建虚拟机集群](创建虚拟机集群.md)。
-   已创建“经典型弹性负载均衡“实例，创建经典型弹性负载均衡的详细步骤请参考[创建经典型负载均衡器](https://support.huaweicloud.com/qs-elb/zh-cn_topic_0015479967.html)。

    启用Istio服务网格


1.  通过上述两处操作入口，点击“启用Istio服务网格“，进入到创建流程界面。
2.  部署模式：
    -   独享模式：将为您纳管专属节点，用于部署Istio控制面组件，非Istio控制面负载将无法调度到该专属节点上，资源隔离，推荐使用；独享模式需要您有充足的节点配额和磁盘配额，一个节点需要配备40G系统盘及100G数据盘，高可用模式需要两个节点配额（四个磁盘配额），单点模式需要一个节点配额（两个磁盘配额）；
    -   共享模式：会将Istio控制面组件部署在您的集群节点上，请确保集群内有可用节点，否则无法启用共享模式Istio服务网格；共享模式Istio控制面与数据面未做隔离，可能产生未知问题，生产环境建议您使用独享模式。

3.  计费模式：支持“按需计费“和“包年/包月“类型。
4.  高可用：
    -   是，选择高可用模式将为您纳管两个独享节点，Istio控制面多实例部署，显著提升Istio控制面稳定性，推荐使用；
    -   否，仅为您纳管一个独享节点，单点模式，Istio控制面组件单实例，性能及稳定性欠佳。

5.  选择地域和可用分区。
    -   当前区域：节点实例所在的物理位置。
    -   可用区：指在同一地域下，电力、网络隔离的物理区域，可用分区之间内网互通，不同可用分区之间物理隔离。

6.  负载均衡实例：此弹性负载均衡实例将作为服务网格对外访问入口，被服务网格管理的应用流量，将均从此实例进入并分发到后端服务。
7.  节点规格：请单击![](figures/icon-add.png)，选择所需的规格。新建节点的CPU配额和内存配额，请根据业务需求，参考提供的推荐规格来选择，参见[规格推荐](null.md)。
8.  选择登录方式。当前支持密码和密钥对。
    -   登录方式为“密码“：请输入登录节点的密码，并确认密码。
    -   登录方式为“密钥对“：选择登录节点的密钥对。

        密钥对用于远程登录节点时的身份认证，若没有密钥对，可单击“创建密钥对”来新建。


9.  节点配额：此处为节点配额提示，请参考。
10. 立即购买按钮：
    -   若为共享模式，则选择负载均衡实例后，点击“立即购买”，将直接跳转到提交成功页，预计需要5分钟；
    -   若为独享-按需模式，点击“立即购买”，确认订单无误后，单击“提交“，开始启用Istio，预计需要6-10分钟；
    -   若为独享-包周期，需选择购买时长，确认订单无误后，点击“去支付”，请根据界面提示进行付款，付款成功开始启用Istio，预计需要6-10分钟。

11. 提交或订单支付成功后，可在集群列表Istio图标的悬浮提示处，查看Istio启用状态。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >-   包年包月购买方式，会自动创建云服务器。若创建失败，该失败回滚过程会根据云服务器的统一收费策略来收取费用。若出现失败回滚类的收费，支持填写工单申请退款。  


