# 新建节点（包年包月）<a name="cce_01_0003"></a>

节点是指接入到平台的计算资源，包括虚拟机、物理机等。用户需确保所在项目节点资源充足，若节点资源不足，会导致创建工作负载等操作失败。

## 使用约束<a name="section103205496263"></a>

-   若需要创建包年包月的节点，请确保至少已创建了一个集群，您可以选择创建一个没有节点的空集群，具体步骤请参见[创建虚拟机集群](创建虚拟机集群.md)。
-   （可选）若您选择密钥对登录节点，您需要提前创建密钥对，用于登录节点时的身份认证。具体步骤请参见[表1](#t31ae09fd9d294eabbb5bbf922752fff6)。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >若已创建密钥对，可多次使用，无需重复创建。  

    **表 1**  创建密钥对

    <a name="t31ae09fd9d294eabbb5bbf922752fff6"></a>
    <table><thead align="left"><tr id="cce_01_0033_row1364210523814"><th class="cellrowborder" valign="top" width="20.43%" id="mcps1.2.3.1.1"><p id="cce_01_0033_p10642157388"><a name="cce_01_0033_p10642157388"></a><a name="cce_01_0033_p10642157388"></a>类别</p>
    </th>
    <th class="cellrowborder" valign="top" width="79.57%" id="mcps1.2.3.1.2"><p id="cce_01_0033_p0642195163816"><a name="cce_01_0033_p0642195163816"></a><a name="cce_01_0033_p0642195163816"></a>操作步骤</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="cce_01_0033_row16421953380"><td class="cellrowborder" valign="top" width="20.43%" headers="mcps1.2.3.1.1 "><p id="cce_01_0033_p864275103813"><a name="cce_01_0033_p864275103813"></a><a name="cce_01_0033_p864275103813"></a>（可选）创建密钥对</p>
    </td>
    <td class="cellrowborder" valign="top" width="79.57%" headers="mcps1.2.3.1.2 "><p id="cce_01_0033_p156423514389"><a name="cce_01_0033_p156423514389"></a><a name="cce_01_0033_p156423514389"></a>您需要新建一个密钥对，用于远程登录节点时的身份认证。</p>
    <a name="cce_01_0033_ol1064212563819"></a><a name="cce_01_0033_ol1064212563819"></a><ol id="cce_01_0033_ol1064212563819"><li>登录管理控制台。</li><li>在服务列表中，选择“计算 &gt; 弹性云服务器”。</li><li>选择左侧导航中的“密钥对”，单击“创建密钥对”。</li><li>输入密钥对名称后，单击“确定”。</li><li>在弹出的对话框中，单击“确定”。<p id="cce_01_0033_p10642185143813"><a name="cce_01_0033_p10642185143813"></a><a name="cce_01_0033_p10642185143813"></a>请根据提示信息，查看并保存密钥对。为保证安全，私钥只能下载一次，请妥善保管，否则将无法登录节点。</p>
    </li></ol>
    </td>
    </tr>
    </tbody>
    </table>


## 创建节点<a name="section19320144922620"></a>

1.  登录CCE控制台，在左侧导航栏中选择“资源管理 \> 集群管理”，单击需要添加节点集群后的“新增节点  \>  购买节点“。
2.  计费模式：支持“按需计费“和“包年/包月“类型。本章讲解包年包月类型的操作。按需计费请参见[新建节点（按需计费）](新建节点（按需计费）.md)。
3.  选择地域和可用分区。
    -   当前区域：节点实例所在的物理位置。
    -   可用区：指在同一地域下，电力、网络隔离的物理区域，可用分区之间内网互通，不同可用分区之间物理隔离。

4.  配置节点规格和节点个数。
    -   节点名称：自定义节点名称。
    -   节点规格：请单击![](figures/icon-add.png)，选择所需的规格。新建节点的CPU配额和内存配额，请根据业务需求来选择。
    -   操作系统：请选择节点对应的操作系统。

5.  配置网络。弹性IP是独立申请的公网IP地址。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >若新增节点有互联网访问的需求，则弹性IP请选择“使用已有“。若新增节点未绑定弹性IP，则在该节点上运行的工作负载将不能被外网访问。  

    -   暂不使用：不使用弹性IP的节点不能与互联网互通，仅可作为私有网络中部署业务或者集群所需云服务器进行使用。
    -   使用已有：为当前节点分配已有弹性IP，请选择已有的弹性IP。

6.  设置节点磁盘空间。分为系统盘和数据盘。

    -   系统盘的规格为\[40, 1024\]GB，用户可以配置，缺省值为40GB。
    -   数据盘的规格为\[100, 32678\]GB，用户可以配置，缺省值为100GB。

    提供以下性能规格的云硬盘。

    -   普通IO：提供可靠的块存储，单个云硬盘的最大IOPS可达到1000，可运行关键应用程序。
    -   高IO：提供可达到3000的高IO和低至1 ms的读写延时，支持NoSQL/关系型数据库，数据仓库，文件系统等应用。
    -   超高IO：提供可达到20000的超高IO和低至1 ms超低读写时延，支持NoSQL/关系型数据库，数据仓库等应用。

    资源分配自定义：用户可自定义数据盘中Docker和Kubelet的资源占比，Docker资源包含Docker镜像数据以及镜像元数据，Kubelet资源包含Pod配置文件、密钥以及临时存储EmptyDir等挂载数据。

7.  选择登录方式。当前支持密码和密钥对。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >当前仅最新集群支持密码方式登录。  

    -   登录方式为“密码“：请输入登录节点的密码，并确认密码。
    -   登录方式为“密钥对“：选择登录节点的密钥对。

        密钥对用于远程登录节点时的身份认证，若没有密钥对，可单击“创建密钥对”来新建。


8.  高级设置：当您有如下需求时，请单击“现在配置“，使用文件注入功能将文件注入到节点：

    -   需要通过脚本简化弹性云服务器配置。
    -   通过脚本初始化系统。
    -   已有脚本，在创建弹性云服务器时一并上传到服务器。
    -   其他可以使用脚本完成的事情。

    **操作步骤如下：**

    1.  设置最大实例数。

        最大实例数是指节点允许创建的最大实例数（Pod），包含系统默认的实例，防止节点因管理过多的实例而负载过重。

    2.  单击“增加一个文件“。
    3.  输入保存路径或文件名：Linux系统请输入注入文件保存路径，例如 “/etc/foo.txt”，文件名只能包含字母和数字。
    4.  单击“选择文件“，选择已写好的脚本，脚本符合操作系统要求即可。

9.  设置节点购买数量和购买时长。
    -   节点购买数量：请根据业务需求设置，但不能超过集群管理的最大节点规模。
    -   购买时长：购买节点时长。

10. 设置完成后，单击“立即购买”。确认订单无误后，单击“去支付”，请根据界面提示进行付款。

    系统将跳转到节点列表页面，待节点状态为“可用“，表示节点添加成功。添加节点预计需要6-10分钟左右，请耐心等待。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >-   若创建节点时，提示弹性IP配额不足，请参照[如何解决新增节点时提示弹性IP不足的问题？](如何解决新增节点时提示弹性IP不足的问题.md)方法解决。  
    >-   添加节点时会自动创建云服务器。若创建失败，该失败回滚过程会根据云服务器的统一收费策略来收取费用。若出现失败回滚类的收费，支持填写工单申请退款。  


## 登录节点<a name="section16476192312530"></a>

使用密钥方式登录CCE创建的虚拟机节点，请参考[SSH密钥方式登录](https://support-intl.huaweicloud.com/zh-cn/usermanual-ecs/zh-cn_topic_0017955380.html)。

>![](public_sys-resources/icon-note.gif) **说明：**   
>-   本地使用Windows操作系统登录Linux节点时，输入的镜像用户名（Auto-login username）为root。  
>-   CCE控制台不提供针对节点的操作系统升级，也不建议您通过yum方式进行升级，如果您在节点上通过 yum update 升级了操作系统，会导致容器网络的组件不可用。手动恢复方式请参见[如何解决yum update升级操作系统导致容器网络不可用问题？](https://support.huaweicloud.com/cce_faq/cce_faq_00182.html)  

## 删除节点<a name="section16844154721815"></a>

删除该节点会将节点以及节点内运行的业务都销毁，请谨慎操作。

1.  登录CCE控制台，选择“资源管理 \> 节点管理“，单击节点后的“删除“。
2.  根据系统提示进行删除操作。

    若未按照界面提示清理CCE相关资源，后续需要清理资源时请参照[如何快速清理CCE节点组件？](如何快速清理CCE节点组件.md)中操作处理。


