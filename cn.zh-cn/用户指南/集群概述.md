# 集群概述<a name="cce_01_0002"></a>

随着应用程序开发向基于容器的方向发展，编排和管理资源的需求变得越来越重要。Kubernetes是一个开源的、功能强大的容器编排系统，用于管理容器化应用和服务，它提供了应用部署、规划、更新、维护的一种机制，让部署容器化的应用更加简单并且高效。

云容器引擎（Cloud Container Engine，以下简称CCE）是一种托管的Kubernetes服务，可进一步简化基于容器的应用程序部署和管理，您可以在CCE中方便的创建Kubernetes集群、部署您的容器化应用，以及方便的管理和维护。

## 集群优势<a name="section3422450142310"></a>

传统的应用部署方式是通过插件或脚本来安装应用。这样做的缺点是应用的运行、配置、管理、所有生存周期将与当前操作系统绑定，这样做并不利于应用的升级更新/回滚等操作，当然也可以通过创建虚拟机的方式来实现某些功能，但是虚拟机非常重，并不利于可移植性。

新的方式是通过部署容器方式实现，每个容器之间互相隔离，每个容器有自己的文件系统，容器之间进程不会相互影响，能区分计算资源。相对于虚拟机，容器能快速部署，由于容器与底层设施、机器文件系统解耦的，所以它能在不同云、不同版本操作系统间进行迁移。

容器占用资源少、部署快，每个应用可以被打包成一个容器镜像，每个应用与容器间成一对一关系也使容器有更大优势，使用容器可以在build或release的阶段，为应用创建容器镜像，因为每个应用不需要与其余的应用堆栈组合，也不依赖于生产环境基础结构，这使得从研发到测试、生产能提供一致环境。类似地，容器比虚拟机轻量、更“透明”，这更便于监控和管理。

集群（Cluster）是容器运行所需云资源的集合，包含了若干云服务器节点（物理服务器或者虚拟机）、负载均衡、虚拟私有云等华为云资源，您可以在集群中运行您的应用程序。在CCE中，我们可以创建若干集群，每个集群可以创建多个容器，每个容器里面运行一个应用实例，然后通过内置的负载均衡策略，实现对这一组应用实例的管理、发现、访问，而这些细节都不需要运维人员去进行复杂的手工配置和处理。

## 集群架构<a name="section1972685513394"></a>

CCE采用兼容标准的Kubernetes集群，Kubernetes集群属于主从分布式架构，主要由Master和Worker Node组成，以及包括客户端命令行工具kubectl和其它附加项。因此，在CCE集群中至少包含一个Master和多个Worker Node，这些Worker Node称为工作节点，这些节点都运行在Kubernetes集群编排系统中。

下图简要介绍了CCE集群的架构：

**图 1**  集群架构图<a name="fig9251347103413"></a>  
![](figures/集群架构图.png "集群架构图")

-   **Master：**管控集群的管理面节点，提供Kubernetes核心服务和应用程序工作负载的业务流程，对集群进行调度管理。Master Node由API Server、Scheduler、Cluster State Store和Controller-Manager Server所组成。
-   **Node：**业务运行的工作节点，用于运行应用程序的容器工作负载。Worker Node包含kubelet、kube proxy和Container Runtime。
-   kubectl：用于通过命令行与API Server进行交互，而对Kubernetes进行操作，实现在集群中进行各种资源的增删改查等操作。
-   replication Controller：副本控制器，用于伸缩副本数量。
-   Pod：实例（Pod）是Kubernetes部署应用或服务的最小的基本单位。一个Pod封装多个应用容器（也可以只有一个容器）、存储资源、一个独立的网络IP以及管理控制容器运行方式的策略选项。
-   Container：容器。一个通过Docker镜像创建的运行实例，一个节点可运行多个容器。容器的实质是进程，但与直接在宿主执行的进程不同，容器进程运行于属于自己的独立的命名空间。
-   Label：标签。其实就一对key/value ，被关联到对象上，比如Pod、标签的使用我们倾向于能够标示对象的特殊特点，并且对用户而言是有意义的，但是标签对内核系统是没有直接意义的。
-   Service：服务，将运行在一组Pods上的应用程序公开为网络服务的抽象方法。

## CCE集群类型<a name="section1129712104414"></a>

云容器引擎CCE深度整合华为云高性能的计算（ECS/BMS）、网络（VPC/EIP/ELB）、存储（EVS/OBS/SFS）等服务，并支持GPU、ARM、FPGA等异构计算架构，支持多可用区（Available zone，简称AZ）、多区域（Region）容灾等技术构建高可用Kubernetes集群。

CCE已支持如下多种类型的集群创建，以满足您各种业务需求：

**表 1**  集群类型对比

<a name="table8289045224"></a>
<table><thead align="left"><tr id="row19289164182216"><th class="cellrowborder" colspan="2" valign="top" id="mcps1.2.5.1.1"><p id="p1628917416228"><a name="p1628917416228"></a><a name="p1628917416228"></a>维度</p>
</th>
<th class="cellrowborder" valign="top" id="mcps1.2.5.1.2"><p id="p4289544222"><a name="p4289544222"></a><a name="p4289544222"></a>CCE集群</p>
</th>
<th class="cellrowborder" valign="top" id="mcps1.2.5.1.3"><p id="p17289346220"><a name="p17289346220"></a><a name="p17289346220"></a>CCE Turbo集群</p>
</th>
</tr>
</thead>
<tbody><tr id="row132892412218"><td class="cellrowborder" rowspan="2" valign="top" width="13.350000000000001%" headers="mcps1.2.5.1.1 "><p id="p1702121843213"><a name="p1702121843213"></a><a name="p1702121843213"></a>集群</p>
</td>
<td class="cellrowborder" valign="top" width="16.6%" headers="mcps1.2.5.1.1 "><p id="p136288022711"><a name="p136288022711"></a><a name="p136288022711"></a>节点形态</p>
</td>
<td class="cellrowborder" valign="top" width="35.260000000000005%" headers="mcps1.2.5.1.2 "><p id="p11340151510272"><a name="p11340151510272"></a><a name="p11340151510272"></a>支持虚拟机和裸金属服务器混合</p>
</td>
<td class="cellrowborder" valign="top" width="34.79%" headers="mcps1.2.5.1.3 "><p id="p134001516275"><a name="p134001516275"></a><a name="p134001516275"></a>支持虚拟机和裸金属服务器混合</p>
</td>
</tr>
<tr id="row528934132217"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p86287020271"><a name="p86287020271"></a><a name="p86287020271"></a>支持机型</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p969111063112"><a name="p969111063112"></a><a name="p969111063112"></a>通用机型</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p15763163013019"><a name="p15763163013019"></a><a name="p15763163013019"></a>基于擎天软硬件协同架构的机型</p>
</td>
</tr>
<tr id="row105535017265"><td class="cellrowborder" valign="top" width="13.350000000000001%" headers="mcps1.2.5.1.1 "><p id="p19550504260"><a name="p19550504260"></a><a name="p19550504260"></a>安全</p>
</td>
<td class="cellrowborder" valign="top" width="16.6%" headers="mcps1.2.5.1.1 "><p id="p86285011276"><a name="p86285011276"></a><a name="p86285011276"></a>隔离性</p>
</td>
<td class="cellrowborder" valign="top" width="35.260000000000005%" headers="mcps1.2.5.1.2 "><p id="p434031552719"><a name="p434031552719"></a><a name="p434031552719"></a>普通容器，Cgroups隔离</p>
</td>
<td class="cellrowborder" valign="top" width="34.79%" headers="mcps1.2.5.1.3 "><a name="ul621219481562"></a><a name="ul621219481562"></a><ul id="ul621219481562"><li>裸金属服务器：安全容器，支持虚机级别的隔离</li><li>虚拟机：普通容器</li></ul>
</td>
</tr>
<tr id="row19562502266"><td class="cellrowborder" rowspan="3" valign="top" width="13.350000000000001%" headers="mcps1.2.5.1.1 "><p id="p1356550102618"><a name="p1356550102618"></a><a name="p1356550102618"></a>网络</p>
</td>
<td class="cellrowborder" valign="top" width="16.6%" headers="mcps1.2.5.1.1 "><p id="p76288082716"><a name="p76288082716"></a><a name="p76288082716"></a>网络模型</p>
</td>
<td class="cellrowborder" valign="top" width="35.260000000000005%" headers="mcps1.2.5.1.2 "><p id="p1734061519273"><a name="p1734061519273"></a><a name="p1734061519273"></a><strong id="b113401315112712"><a name="b113401315112712"></a><a name="b113401315112712"></a>云原生网络1.0</strong>：面向性能和规模要求不高的场景。</p>
<a name="ul2055005123618"></a><a name="ul2055005123618"></a><ul id="ul2055005123618"><li>隧道网络模式</li><li>VPC网络模式</li></ul>
</td>
<td class="cellrowborder" valign="top" width="34.79%" headers="mcps1.2.5.1.3 "><p id="p43416153272"><a name="p43416153272"></a><a name="p43416153272"></a><strong id="b103412158276"><a name="b103412158276"></a><a name="b103412158276"></a><a href="云原生网络2-0.md">云原生网络2.0</a></strong>：面向大规模和高性能的场景。</p>
<p id="p434120150271"><a name="p434120150271"></a><a name="p434120150271"></a>组网规模2000节点</p>
</td>
</tr>
<tr id="row133581631175511"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p2800173617559"><a name="p2800173617559"></a><a name="p2800173617559"></a>网络性能</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p58001736135520"><a name="p58001736135520"></a><a name="p58001736135520"></a>VPC网络叠加容器网络，性能有一定损耗</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p1680023625516"><a name="p1680023625516"></a><a name="p1680023625516"></a>VPC网络和容器网络融合，性能无损耗</p>
</td>
</tr>
<tr id="row1328914432215"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p1362811017275"><a name="p1362811017275"></a><a name="p1362811017275"></a>容器网络隔离</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><a name="ul29571941173617"></a><a name="ul29571941173617"></a><ul id="ul29571941173617"><li>隧道网络模式：集群内部网络隔离策略，支持Networkpolicy。</li><li>VPC网络模式：不支持</li></ul>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p6665152413463"><a name="p6665152413463"></a><a name="p6665152413463"></a>基于安全组的隔离策略，支持集群内外部统一的安全隔离，支持SecurityGroup。</p>
</td>
</tr>
</tbody>
</table>

>![](public_sys-resources/icon-caution.gif) **注意：** 
>-   在创建、删除、扩容和缩容集群的操作中，请不要在统一身份认证服务（IAM）中执行权限变更或修改的操作，可能会导致创建、删除、扩容和缩容集群执行失败。
>-   CCE节点的容器网络canal会使用一个网段作为容器网络的网段，该网段在创建集群时可配置，默认为172.16.0.0/16；docker服务也会默认创建一个docker0的网桥，docker0的默认地址为172.17.0.1。创建集群时，请确保集群中VPC（虚拟私有云）所在的网段不能和上述两个网段重复。使用VPC的对等连接功能时，对端的VPC也不能和上述两个网段重复。

## 后续步骤<a name="section1144020144811"></a>

有关CCE概念和具体操作的详细信息，请参阅以下文章：

-   [购买并创建一个CCE集群](购买CCE集群.md)
-   [通过kubectl或web-terminal插件操作CCE集群](通过kubectl或web-terminal插件操作CCE集群.md)
-   [创建无状态负载\(Deployment\)](创建无状态负载(Deployment).md)
-   [如何通过设置负载均衡\(LoadBalancer\)让公网用户访问](负载均衡(LoadBalancer).md)

